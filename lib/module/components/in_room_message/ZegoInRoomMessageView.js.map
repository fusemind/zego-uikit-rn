{"version":3,"names":["React","useEffect","useState","useRef","FlatList","Text","StyleSheet","View","ZegoUIKitInternal","ZegoInRoomMessageView","props","itemBuilder","listRef","messageList","setMessageList","refreshMessage","arr","getInRoomMessages","renderItem","item","styles","messageContainer","nameLabel","sender","userName","messageLabel","message","callbackID","String","Math","floor","random","onInRoomMessageReceived","onInRoomMessageSent","error","messageID","current","scrollToEnd","create","alignSelf","backgroundColor","borderRadius","flexDirection","justifyContent","alignItems","marginTop","paddingTop","paddingBottom","paddingRight","paddingLeft","color","fontSize","marginLeft"],"sources":["ZegoInRoomMessageView.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { FlatList, Text, StyleSheet, View } from 'react-native';\nimport ZegoUIKitInternal from '../internal/ZegoUIKitInternal';\n\nexport default function ZegoInRoomMessageView(props) {\n  const { itemBuilder } = props;\n  const listRef = useRef(null);\n  const [messageList, setMessageList] = useState([]);\n\n  const refreshMessage = () => {\n    // setTimeOut(()=>null)\n    // Update list like this will cause rerender\n    setMessageList((arr) => [...ZegoUIKitInternal.getInRoomMessages()]);\n  };\n  const renderItem = ({ item }) => {\n    return (\n      !itemBuilder ? <View style={styles.messageContainer}>\n        <Text style={styles.nameLabel}>\n          {item.sender.userName}\n          <Text style={styles.messageLabel}> {item.message}</Text>\n        </Text>\n      </View> : <Delegate to={itemBuilder} props={{ message: item }} />\n    );\n  }\n\n  useEffect(() => {\n    refreshMessage();\n  }, []);\n  useEffect(() => {\n    const callbackID =\n      'ZegoInRoomMessageView' + String(Math.floor(Math.random() * 10000));\n    ZegoUIKitInternal.onInRoomMessageReceived(callbackID, (messageList) => {\n      refreshMessage();\n    });\n    ZegoUIKitInternal.onInRoomMessageSent(callbackID, (error, messageID) => {\n      refreshMessage();\n    });\n\n    return () => {\n      ZegoUIKitInternal.onInRoomMessageReceived(callbackID);\n      ZegoUIKitInternal.onInRoomMessageSent(callbackID);\n    };\n  }, []);\n  return (\n    <FlatList\n      showsVerticalScrollIndicator={false}\n      ref={listRef}\n      data={messageList}\n      // https://stackoverflow.com/questions/46304677/scrolltoend-after-update-data-for-flatlist\n      onContentSizeChange={() => listRef.current.scrollToEnd()}\n      renderItem={renderItem}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  messageContainer: {\n    alignSelf: 'flex-start',\n    backgroundColor: 'rgba(1, 7, 18, 0.3000)',\n    borderRadius: 13,\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n    alignItems: 'center',\n    marginTop: 4,\n    paddingTop: 5,\n    paddingBottom: 5,\n    paddingRight: 10,\n    paddingLeft: 10,\n  },\n  nameLabel: {\n    color: '#8BE7FF',\n    fontSize: 13,\n    // marginLeft: 10\n  },\n  messageLabel: {\n    color: 'white',\n    fontSize: 13,\n    marginLeft: 5,\n  },\n});\n"],"mappings":"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"}