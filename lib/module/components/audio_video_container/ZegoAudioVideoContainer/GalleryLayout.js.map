{"version":3,"names":["React","useEffect","useState","StyleSheet","View","Text","ZegoUIKitInternal","ZegoAudioVideoView","ZegoAudioVideoViewMore","GalleryLayout","props","config","foregroundBuilder","audioVideoConfig","addBorderRadiusAndSpacingBetweenView","ownViewBackgroundColor","othersViewBackgroundColor","ownViewBackgroundImage","othersViewBackgroundImage","useVideoViewAspectFill","showSoundWavesInAudioMode","localUserID","setLocalUserID","userList","setUserList","moreUserList","setMoreUserList","callbackID","String","Math","floor","random","onSDKConnected","getLocalUserInfo","userID","onRoomStateChanged","reason","errorCode","extendedData","onUserCountOrPropertyChanged","index","findIndex","user","splice","concat","slice","getAudioVideoViewStyle","len","length","audioVideoViewSizeStyle","styles","audioVideoViewSize1","audioVideoViewSize2","audioVideoViewSize4","audioVideoViewSize6","audioVideoViewSize8","audioVideoViewSizeMore","isAudioVideoViewPadding","audioVideoViewPadding","isAudioVideoViewBorder","audioVideoViewBorder","container","map","audioVideoViewContainer","audioVideoViewSubContainer","create","flex","width","height","backgroundColor","flexDirection","flexWrap","zIndex","overflow","background","borderRadius","paddingLeft","paddingRight","paddingTop","paddingBottom"],"sources":["GalleryLayout.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { StyleSheet, View, Text } from 'react-native'\nimport ZegoUIKitInternal from \"../../internal/ZegoUIKitInternal\";\nimport ZegoAudioVideoView from \"../../audio_video/ZegoAudioVideoView\";\nimport ZegoAudioVideoViewMore from \"./MoreFrame\";\n\nexport default function GalleryLayout(props) {\n    const { config = {}, foregroundBuilder, audioVideoConfig = {} } = props;\n    const {\n        addBorderRadiusAndSpacingBetweenView = true, // Whether to display rounded corners and spacing between Views\n        ownViewBackgroundColor = '',\n        othersViewBackgroundColor = '',\n        ownViewBackgroundImage = '',\n        othersViewBackgroundImage = '',\n    } = config;\n    const {\n        useVideoViewAspectFill = false,\n        showSoundWavesInAudioMode = true,\n    } = audioVideoConfig;\n\n    const [localUserID, setLocalUserID] = useState('');\n    const [userList, setUserList] = useState([]);\n    const [moreUserList, setMoreUserList] = useState([]);\n\n    useEffect(() => {\n        const callbackID = 'GalleryLayout' + String(Math.floor(Math.random() * 10000));\n        ZegoUIKitInternal.onSDKConnected(callbackID, () => {\n            setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n        });\n        ZegoUIKitInternal.onRoomStateChanged(callbackID, (reason, errorCode, extendedData) => {\n            if (reason == 1 || reason == 4) {\n                setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n            } else if (reason == 2 || reason == 5 || reason == 6 || reason == 7) {\n                // ZegoRoomStateChangedReasonLoginFailed\n                // ZegoRoomStateChangedReasonReconnectFailed\n                // ZegoRoomStateChangedReasonKickOut\n                // ZegoRoomStateChangedReasonLogout\n                // ZegoRoomStateChangedReasonLogoutFailed\n                setLocalUserID('');\n            }\n        })\n        ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID, (userList) => {\n            // console.warn('>>>>>>>>>>> onUserCountOrPropertyChanged', userList)\n            // Put yourself first\n            const index = userList.findIndex((user => user.userID == ZegoUIKitInternal.getLocalUserInfo().userID));\n            index !== -1 && (userList = userList.splice(index, 1).concat(userList));\n            setUserList(userList.slice(0, 7));\n            setMoreUserList(userList.slice(7));\n        });\n        return () => {\n            ZegoUIKitInternal.onSDKConnected(callbackID);\n            ZegoUIKitInternal.onRoomStateChanged(callbackID);\n            ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID);\n        }\n    }, []);\n\n    const getAudioVideoViewStyle = () => {\n        const len = userList.length;\n        let audioVideoViewSizeStyle;\n        switch (len) {\n            case 1:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize1;\n                break;\n            case 2:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize2;\n                break;\n            case 3:\n            case 4:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize4;\n                break;\n            case 5:\n            case 6:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize6;\n                break;\n            case 7:\n            case 8:\n                audioVideoViewSizeStyle = styles.audioVideoViewSize8;\n                break;\n            default:\n                audioVideoViewSizeStyle = styles.audioVideoViewSizeMore;\n                break;\n        }\n        return audioVideoViewSizeStyle;\n    }\n\n    const isAudioVideoViewPadding = addBorderRadiusAndSpacingBetweenView && userList.length > 1 ? styles.audioVideoViewPadding : null;\n    const isAudioVideoViewBorder = addBorderRadiusAndSpacingBetweenView && userList.length > 1 ? styles.audioVideoViewBorder : null;\n\n    return (<View style={[styles.container, isAudioVideoViewPadding]}>\n        {\n            userList.map((user, index) => <View key={user.userID} style={[\n                styles.audioVideoViewContainer,\n                getAudioVideoViewStyle(),\n                isAudioVideoViewPadding\n            ]}>\n                <View style={[styles.audioVideoViewSubContainer, isAudioVideoViewBorder]}>\n                    <ZegoAudioVideoView\n                        userID={user.userID}\n                        audioViewBackgroudColor={user.userID == ZegoUIKitInternal.getLocalUserInfo().userID ? ownViewBackgroundColor : othersViewBackgroundColor}\n                        audioViewBackgroudImage={user.userID == ZegoUIKitInternal.getLocalUserInfo().userID ? ownViewBackgroundImage : othersViewBackgroundImage}\n                        showSoundWave={showSoundWavesInAudioMode}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        foregroundBuilder={foregroundBuilder}\n                    />\n                </View>\n            </View>)\n        }\n        {\n            moreUserList.length <=1 ? moreUserList.map((user, index) => <View key={user.userID} style={[\n                styles.audioVideoViewContainer,\n                getAudioVideoViewStyle(),\n                isAudioVideoViewPadding\n            ]}>\n                <View style={[styles.audioVideoViewSubContainer, isAudioVideoViewBorder]}>\n                    <ZegoAudioVideoView\n                        userID={user.userID}\n                        audioViewBackgroudColor={user.userID == ZegoUIKitInternal.getLocalUserInfo().userID ? ownViewBackgroundColor : othersViewBackgroundColor}\n                        audioViewBackgroudImage={user.userID == ZegoUIKitInternal.getLocalUserInfo().userID ? ownViewBackgroundImage : othersViewBackgroundImage}\n                        showSoundWave={showSoundWavesInAudioMode}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        foregroundBuilder={foregroundBuilder}\n                    />\n                </View>\n            </View>) : <View style={[styles.audioVideoViewContainer, getAudioVideoViewStyle(), isAudioVideoViewPadding]}>\n                <View style={[styles.audioVideoViewSubContainer, isAudioVideoViewBorder]}>\n                    <ZegoAudioVideoViewMore \n                        userList={moreUserList}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        audioViewBackgroudColor={othersViewBackgroundColor}\n                        audioViewBackgroudImage={othersViewBackgroundImage}\n                    />\n                </View>\n            </View>\n        }\n    </View>)\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        width: '100%',\n        height: '100%',\n        backgroundColor: '#171821',\n        flexDirection: 'row',\n        flexWrap: 'wrap'\n    },\n    audioVideoViewContainer: {\n        zIndex: 1,\n    },\n    audioVideoViewSubContainer: {\n        width: '100%',\n        height: '100%',\n        overflow: 'hidden',\n        background: '#D8D8D8',\n    },\n    audioVideoViewBorder: {\n        borderRadius: 10,\n    },\n    audioVideoViewPadding: {\n        paddingLeft: 2.5,\n        paddingRight: 2.5,\n        paddingTop: 2.5,\n        paddingBottom: 2.5,\n    },\n\n    audioVideoViewSize1: {\n        width: '100%',\n        height: '100%',\n    },\n    audioVideoViewSize2: {\n        width: '100%',\n        height: '50%',\n    },\n    audioVideoViewSize4: {\n        width: '50%',\n        height: '50%',\n    },\n    audioVideoViewSize6: {\n        width: '50%',\n        height: '33.33%',\n    },\n    audioVideoViewSize8: {\n        width: '50%',\n        height: '25%',\n    },\n    audioVideoViewSizeMore: {\n        width: '50%',\n        height: '25%',\n    },\n});"],"mappings":"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"}