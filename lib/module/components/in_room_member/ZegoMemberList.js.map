{"version":3,"names":["React","useEffect","useState","View","ScrollView","FlatList","StyleSheet","Text","TouchableWithoutFeedback","ZegoUIKitInternal","ZegoMicrophoneStateIcon","ZegoCameraStateIcon","Delegate","ZegoMemberList","props","showMicrophoneState","showCameraState","itemBuilder","sortUserList","localUserID","setLocalUserID","memberList","setMemberList","refreshMemberList","console","log","getAllUsers","temp","arr","reverse","index","findIndex","user","userID","getLocalUserInfo","splice","concat","getShotName","name","nl","split","shotName","forEach","part","substring","iconMicView","item","require","iconCameraView","roleDescription","warn","showMe","renderItem","styles","itemLeft","avatar","nameLabel","userName","itemRight","userInfo","callbackID","String","Math","floor","random","onSDKConnected","onRoomStateChanged","reason","errorCode","extendedData","onUserCountOrPropertyChanged","userList","onMemberListForceSort","create","width","flexDirection","alignItems","justifyContent","paddingLeft","paddingRight","height","backgroundColor","borderRadius","marginRight","flex","textAlign","color","fontSize","icon","marginLeft"],"sources":["ZegoMemberList.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport {\n  View,\n  ScrollView,\n  FlatList,\n  StyleSheet,\n  Text,\n  TouchableWithoutFeedback,\n} from 'react-native';\nimport ZegoUIKitInternal from '../internal/ZegoUIKitInternal';\nimport ZegoMicrophoneStateIcon from '../audio_video/ZegoMicrophoneStateIcon';\nimport ZegoCameraStateIcon from '../audio_video/ZegoCameraStateIcon';\nimport Delegate from 'react-delegate-component';\n\nexport default function ZegoMemberList(props) {\n  const { showMicrophoneState, showCameraState, itemBuilder, sortUserList } =\n    props;\n  // let mockList = [\n  //     {\n  //       userID: 'bd7acbea',\n  //       userName: 'First Item',\n  //     },\n  //     {\n  //       userID: '3ac68afc',\n  //       userName: 'Second Item',\n  //     },\n  //     {\n  //       userID: '58694a0f',\n  //       userName: 'Third Item',\n  //     },\n  //     {\n  //         userID: '3ac68afa',\n  //         userName: 'Four Item',\n  //     },\n  //     {\n  //         userID: '58694a0b',\n  //         userName: 'Five Item',\n  //     },\n  //     {\n  //         userID: '3ac68af1',\n  //         userName: 'Six Item',\n  //     },\n  //     {\n  //         userID: '58694a0d',\n  //         userName: 'Seven Item',\n  //     },\n  // ];\n  const [localUserID, setLocalUserID] = useState('');\n  const [memberList, setMemberList] = useState([]);\n\n  const refreshMemberList = () => {\n    console.log('############refreshMemberList')\n    let memberList = ZegoUIKitInternal.getAllUsers();\n    if (typeof sortUserList === 'function') {\n      const temp = sortUserList(memberList) || memberList;\n      setMemberList((arr) => [...temp]);\n    } else {\n      // Update list like this will cause rerender\n      memberList.reverse();\n      // Put yourself first\n      const index = memberList.findIndex(\n        (user) => user.userID == ZegoUIKitInternal.getLocalUserInfo().userID\n      );\n      index !== -1 &&\n        (memberList = memberList.splice(index, 1).concat(memberList));\n      setMemberList((arr) => [...memberList]);\n    }\n  };\n\n  useEffect(() => {\n    refreshMemberList();\n  }, []);\n\n  const getShotName = (name) => {\n    if (!name) {\n      return '';\n    }\n    const nl = name.split(' ');\n    var shotName = '';\n    nl.forEach((part) => {\n      if (part !== '') {\n        shotName += part.substring(0, 1);\n      }\n    });\n    return shotName;\n  };\n\n  const iconMicView = (item) =>\n    showMicrophoneState ? (\n      <ZegoMicrophoneStateIcon\n        iconMicrophoneOn={require('../internal/resources/gray_icon_video_mic_on.png')}\n        iconMicrophoneOff={require('../internal/resources/gray_icon_video_mic_off.png')}\n        iconMicrophoneSpeaking={require('../internal/resources/gray_icon_video_mic_speaking.png')}\n        userID={item.userID}\n      />\n    ) : (\n      <View />\n    );\n  const iconCameraView = (item) =>\n    showCameraState ? (\n      <ZegoCameraStateIcon\n        iconCameraOn={require('../internal/resources/gray_icon_video_camera_on.png')}\n        iconCameraOff={require('../internal/resources/gray_icon_video_camera_off.png')}\n        userID={item.userID}\n      />\n    ) : (\n      <View />\n    );\n\n  const roleDescription = (item) => {\n    console.warn('===============roleDescription==============', item);\n    const localUserID = ZegoUIKitInternal.getLocalUserInfo().userID;\n    const showMe = item.userID == localUserID ? 'You' : '';\n    if (!showMe) {\n      return '';\n    } else {\n      return `(${showMe})`;\n    }\n  };\n\n  const renderItem = ({ item }) =>\n    !itemBuilder ? (\n      <View style={styles.item}>\n        <View style={styles.itemLeft}>\n          <View style={styles.avatar}>\n            <Text style={styles.nameLabel}>{getShotName(item.userName)}</Text>\n          </View>\n          <Text style={styles.name}>\n            {item.userName + roleDescription(item)}\n          </Text>\n        </View>\n        <View style={styles.itemRight}>\n          {iconMicView(item)}\n          {iconCameraView(item)}\n        </View>\n      </View>\n    ) : (\n      <Delegate to={itemBuilder} props={{ userInfo: item }} />\n    );\n\n  useEffect(() => {\n    const callbackID =\n      'ZegoMemberList' + String(Math.floor(Math.random() * 10000));\n    ZegoUIKitInternal.onSDKConnected(callbackID, () => {\n      setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n    });\n    ZegoUIKitInternal.onRoomStateChanged(\n      callbackID,\n      (reason, errorCode, extendedData) => {\n        if (reason == 1 || reason == 4) {\n          setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n        } else if (reason == 2 || reason == 5 || reason == 6 || reason == 7) {\n          // ZegoRoomStateChangedReasonLoginFailed\n          // ZegoRoomStateChangedReasonReconnectFailed\n          // ZegoRoomStateChangedReasonKickOut\n          // ZegoRoomStateChangedReasonLogout\n          // ZegoRoomStateChangedReasonLogoutFailed\n          setLocalUserID('');\n        }\n      }\n    );\n    ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID, (userList) => {\n      console.warn(\n        '===============onUserCountOrPropertyChanged==============',\n        userList\n      );\n      if (typeof sortUserList === 'function') {\n        const temp = sortUserList(userList) || userList;\n        setMemberList((arr) => [...temp]);\n      } else {\n        // Put yourself first\n        const index = userList.findIndex(\n          (user) => user.userID == ZegoUIKitInternal.getLocalUserInfo().userID\n        );\n        index !== -1 && (userList = userList.splice(index, 1).concat(userList));\n        setMemberList((arr) => [...userList]);\n      }\n    });\n    ZegoUIKitInternal.onMemberListForceSort(callbackID, (userList) => {\n      console.log('===============onMemberListForceSort==============', userList)\n      if (typeof sortUserList === 'function') {\n        const temp = sortUserList(userList) || userList;\n        setMemberList((arr) => [...temp]);\n      } else {\n        // Don't deal with\n      }\n    });\n    return () => {\n      ZegoUIKitInternal.onSDKConnected(callbackID);\n      ZegoUIKitInternal.onRoomStateChanged(callbackID);\n      ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID);\n      ZegoUIKitInternal.onMemberListForceSort(callbackID);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <FlatList\n      data={memberList}\n      renderItem={renderItem}\n      keyExtractor={(item) => item.userID}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  item: {\n    width: '100%',\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingLeft: 18,\n    paddingRight: 17,\n    height: 62,\n  },\n  itemLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  avatar: {\n    width: 36,\n    height: 36,\n    backgroundColor: '#DBDDE3',\n    borderRadius: 1000,\n    marginRight: 20,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  nameLabel: {\n    flex: 1,\n    textAlign: 'center',\n    color: '#222222',\n    fontSize: 16,\n  },\n  name: {\n    fontSize: 16,\n    color: '#FFFFFF',\n  },\n  itemRight: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  icon: {\n    width: 35,\n    height: 35,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginLeft: 12,\n  },\n});\n"],"mappings":"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"}