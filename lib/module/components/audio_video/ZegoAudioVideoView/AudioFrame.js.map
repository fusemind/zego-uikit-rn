{"version":3,"names":["View","StyleSheet","Text","ImageBackground","Image","React","useState","useEffect","ZegoUIKitInternal","defaultAvatarSizeRatio","flexStyle","AudioFrame","props","userInfo","showSoundWave","audioViewBackgroudColor","audioViewBackgroudImage","avatarSize","avatarAlignment","soundWaveColor","avatar","soundLevel","setSoundLevel","dimensions","setDimensions","width","height","isLoadError","setIsLoadError","getShotName","name","nl","split","shotName","forEach","part","substring","onSoundLevelUpdate","userID","cstyle","container","event","nativeEvent","layout","uri","styles","imgBackground","justifyContent","waveStyle","circleWave","subCircleWave","nameLabel","userName","resizeMode","console","log","bgColor","create","flex","position","backgroundColor","w","color","opacity","alignSelf","aspectRatio","borderRadius","zIndex","alignContent","marginTop","marginBottom","toString","alignItems","fontSize"],"sources":["AudioFrame.js"],"sourcesContent":["import { View, StyleSheet, Text, ImageBackground, Image } from 'react-native';\nimport React, { useState, useEffect } from 'react';\nimport ZegoUIKitInternal from '../../internal/ZegoUIKitInternal';\n\nconst defaultAvatarSizeRatio = 129 / 375;\nconst flexStyle = ['center', 'flex-start', 'flex-end'];\n\nexport default function AudioFrame(props) {\n  const {\n    userInfo,\n    showSoundWave,\n    audioViewBackgroudColor,\n    audioViewBackgroudImage,\n    avatarSize,\n    avatarAlignment,\n    soundWaveColor = '#6B6A71',\n    avatar = '',\n  } = props;\n\n  const [soundLevel, setSoundLevel] = useState(0);\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n  const [isLoadError, setIsLoadError] = useState(false);\n\n  const getShotName = (name) => {\n    if (!name) {\n      return '';\n    }\n    const nl = name.split(' ');\n    var shotName = '';\n    nl.forEach((part) => {\n      if (part !== '') {\n        shotName += part.substring(0, 1);\n      }\n    });\n    return shotName;\n  };\n\n  useEffect(() => {\n    ZegoUIKitInternal.onSoundLevelUpdate(\n      'AudioFrame' + userInfo.userID,\n      (userID, soundLevel) => {\n        if (userInfo.userID == userID) {\n          setSoundLevel(soundLevel);\n        }\n      }\n    );\n\n    return () => {\n      ZegoUIKitInternal.onSoundLevelUpdate('AudioFrame' + userInfo.userID);\n    };\n  }, []);\n\n  return (\n    <View\n      style={\n        cstyle(audioViewBackgroudColor ? audioViewBackgroudColor : '#4A4B4D')\n          .container\n      }\n      onLayout={(event) => {\n        setDimensions({\n          width: event.nativeEvent.layout.width,\n          height: event.nativeEvent.layout.height,\n        });\n      }}\n    >\n      <ImageBackground\n        source={\n          audioViewBackgroudImage ? { uri: audioViewBackgroudImage } : null\n        }\n        resizeMode=\"cover\"\n        style={[\n          styles.imgBackground,\n          { justifyContent: flexStyle[avatarAlignment] },\n        ]}\n      >\n        {showSoundWave && soundLevel > 5 ? (\n          <View\n            style={\n              waveStyle(\n                (avatarSize\n                  ? avatarSize.width\n                  : defaultAvatarSizeRatio * dimensions.width) +\n                  0.04 * dimensions.width,\n                soundWaveColor,\n                1\n              ).circleWave\n            }\n          >\n            {soundLevel > 10 ? (\n              <View\n                style={\n                  waveStyle(\n                    (avatarSize\n                      ? avatarSize.width\n                      : defaultAvatarSizeRatio * dimensions.width) +\n                      0.06 * dimensions.width,\n                    soundWaveColor,\n                    0.6\n                  ).subCircleWave\n                }\n              />\n            ) : null}\n            {soundLevel > 15 ? (\n              <View\n                style={\n                  waveStyle(\n                    (avatarSize\n                      ? avatarSize.width\n                      : defaultAvatarSizeRatio * dimensions.width) +\n                      +0.08 * dimensions.width,\n                    soundWaveColor,\n                    0.3\n                  ).subCircleWave\n                }\n              />\n            ) : null}\n          </View>\n        ) : (\n          <View />\n        )}\n        <View\n          style={[\n            styles.avatar,\n            {\n              width: avatarSize\n                ? avatarSize.width\n                : defaultAvatarSizeRatio * dimensions.width,\n            },\n          ]}\n        >\n          {\n            (!avatar || isLoadError) ?\n              <Text style={styles.nameLabel}>{getShotName(userInfo.userName)}</Text> :\n              <Image \n                style={{ width: '100%', height: '100%', resizeMode: 'contain' }}\n                resizeMode=\"contain\"\n                source={{ uri: avatar }}\n                onLoadStart={() =>  console.log('avatar onLoadStart')}\n                onLoadEnd={() =>  console.log('avatar onLoadEnd')}\n                onError={() =>  { console.log('avatar onError'); setIsLoadError(true);}}\n                onLoad={() =>  { console.log('avatar onLoad'); setIsLoadError(false);}}\n              />\n          }\n        </View>\n      </ImageBackground>\n    </View>\n  );\n}\n\nconst cstyle = (bgColor) =>\n  StyleSheet.create({\n    container: {\n      flex: 1,\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      justifyContent: 'center',\n      backgroundColor: bgColor,\n    },\n  });\nconst waveStyle = (w, color, opacity) =>\n  StyleSheet.create({\n    circleWave: {\n      flex: 1,\n      position: 'absolute',\n      alignSelf: 'center',\n      width: w, //((w / 375) * 100).toString() + '%',\n      aspectRatio: 1,\n      borderRadius: 1000,\n      backgroundColor: color,\n      opacity: opacity,\n      zIndex: 0,\n      justifyContent: 'center',\n      alignContent: 'center',\n    },\n    subCircleWave: {\n      flex: 1,\n      position: 'absolute',\n      alignSelf: 'center',\n      width: w, //((w / 164) * 100).toString() + '%',\n      aspectRatio: 1,\n      borderRadius: 1000,\n      backgroundColor: color,\n      opacity: opacity,\n      zIndex: 0,\n    },\n  });\nconst styles = StyleSheet.create({\n  imgBackground: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n  },\n  avatar: {\n    flex: 1,\n    marginTop: 1.5,\n    marginBottom: 1.5,\n    width: ((129 / 375) * 100).toString() + '%',\n    aspectRatio: 1,\n    borderRadius: 1000,\n    backgroundColor: '#DBDDE3',\n    position: 'absolute',\n    alignSelf: 'center',\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: 2,\n  },\n  nameLabel: {\n    flex: 1,\n    position: 'absolute',\n    color: '#222222',\n    fontSize: 22,\n  },\n});\n"],"mappings":"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"}