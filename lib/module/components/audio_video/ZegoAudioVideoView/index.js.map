{"version":3,"names":["React","useEffect","useState","View","StyleSheet","Text","Delegate","AudioFrame","VideoFrame","ZegoUIKitInternal","MaskViewDefault","props","userInfo","userName","styles","defaultMaskContainer","defaultMaskNameLabelContainer","defaultMaskNameLabel","ZegoVideoView","userID","roomID","audioViewBackgroudColor","audioViewBackgroudImage","showSoundWave","useVideoViewAspectFill","foregroundBuilder","avatarSize","avatarAlignment","soundWaveColor","setUserInfo","isCameraOn","setIsCameraOn","propsData","setPropsData","userInfo_","getUser","inRoomAttributes","avatar","setAvatarUrl","user","isCameraDeviceOn","callbackID","String","onSDKConnected","onUserInfoUpdate","info","onRoomStateChanged","reason","errorCode","extendedData","isRoomConnected","onUserCountOrPropertyChanged","userList","console","log","forEach","temp","container","videoContainer","mask","create","flex","width","height","position","zIndex","backgroundColor","opacity","alignSelf","paddingLeft","paddingRight","paddingBottom","paddingTop","borderRadius","bottom","right","color","fontSize"],"sources":["index.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { View, StyleSheet, Text } from 'react-native';\nimport Delegate from 'react-delegate-component';\nimport AudioFrame from './AudioFrame';\nimport VideoFrame from './VideoFrame';\nimport ZegoUIKitInternal from '../../internal/ZegoUIKitInternal';\n\nfunction MaskViewDefault(props) {\n  const { userInfo } = props;\n  const { userName = '' } = userInfo;\n  return (\n    <View style={styles.defaultMaskContainer}>\n      <View style={styles.defaultMaskNameLabelContainer}>\n        <Text style={styles.defaultMaskNameLabel}>{userName}</Text>\n      </View>\n    </View>\n  );\n}\n\nexport default function ZegoVideoView(props) {\n  const {\n    userID,\n    roomID,\n    audioViewBackgroudColor,\n    audioViewBackgroudImage,\n    showSoundWave = true,\n    useVideoViewAspectFill = false,\n    foregroundBuilder,\n    avatarSize,\n    avatarAlignment = 0,\n    soundWaveColor,\n  } = props;\n\n  const [userInfo, setUserInfo] = useState({});\n  const [isCameraOn, setIsCameraOn] = useState(true);\n  const [propsData, setPropsData] = useState({ userInfo: {} });\n  const userInfo_ = ZegoUIKitInternal.getUser(userID);\n  const inRoomAttributes = userInfo_ ? userInfo_.inRoomAttributes : {};\n  const [avatar, setAvatarUrl] = useState(inRoomAttributes ? (inRoomAttributes.avatar || '') : '');\n\n  useEffect(() => {\n    const user = ZegoUIKitInternal.getUser(userID);\n    if (user) {\n      setUserInfo(user);\n      setPropsData({ userInfo: user });\n      setIsCameraOn(user.isCameraDeviceOn);\n    }\n  }, []);\n\n  useEffect(() => {\n    const callbackID = 'ZegoVideoView' + String(userID);\n\n    ZegoUIKitInternal.onSDKConnected(callbackID, () => {\n      const user = ZegoUIKitInternal.getUser(userID);\n      if (user) {\n        setUserInfo(user);\n        setPropsData({ userInfo: user });\n        setIsCameraOn(user.isCameraDeviceOn);\n      }\n    });\n    ZegoUIKitInternal.onUserInfoUpdate(callbackID, (info) => {\n      if (info.userID == userID) {\n        setIsCameraOn(info.isCameraDeviceOn);\n        setUserInfo(info);\n        setPropsData({ userInfo: info });\n      }\n    });\n    ZegoUIKitInternal.onRoomStateChanged(\n      callbackID,\n      (reason, errorCode, extendedData) => {\n        if (ZegoUIKitInternal.isRoomConnected()) {\n          const user = ZegoUIKitInternal.getUser(userID);\n          if (user) {\n            setIsCameraOn(user.isCameraDeviceOn);\n          }\n        }\n      }\n    );\n    ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID, (userList) => {\n      console.log('=========[ZegoVideoView]onUserCountOrPropertyChanged=========', userID, userList);\n      userList.forEach((user) => {\n        const temp = user.inRoomAttributes ? user.inRoomAttributes.avatar : '';\n        if (user.userID === userID && temp) {\n          setAvatarUrl(temp);\n        }\n      });\n    });\n    return () => {\n      ZegoUIKitInternal.onSDKConnected(callbackID);\n      ZegoUIKitInternal.onUserInfoUpdate(callbackID);\n      ZegoUIKitInternal.onRoomStateChanged(callbackID);\n      ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID);\n    };\n  }, []);\n\n  return (\n    <View style={styles.container}>\n      <VideoFrame\n        style={styles.videoContainer}\n        userID={userID}\n        roomID={roomID}\n        fillMode={useVideoViewAspectFill ? 1 : 0} // 1:AspectFill, 0:AspectFit\n      >\n        {!isCameraOn ? (\n          <AudioFrame\n            userInfo={userInfo}\n            showSoundWave={showSoundWave}\n            audioViewBackgroudColor={audioViewBackgroudColor}\n            audioViewBackgroudImage={audioViewBackgroudImage}\n            avatarSize={avatarSize}\n            avatarAlignment={avatarAlignment}\n            avatar={avatar}\n            soundWaveColor={soundWaveColor}\n          />\n        ) : null}\n      </VideoFrame>\n\n      <Delegate\n        style={styles.mask}\n        to={foregroundBuilder}\n        default={MaskViewDefault}\n        props={propsData}\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n  },\n  videoContainer: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    zIndex: 1,\n  },\n  mask: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    zIndex: 2,\n  },\n  defaultMaskContainer: {\n    flex: 1,\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    zIndex: 2,\n  },\n  defaultMaskNameLabelContainer: {\n    flex: 1,\n    backgroundColor: '#2A2A2A',\n    opacity: 0.5,\n    position: 'absolute',\n    alignSelf: 'center',\n    paddingLeft: 5,\n    paddingRight: 5,\n    paddingBottom: 3,\n    paddingTop: 3,\n    borderRadius: 6,\n    bottom: 5,\n    right: 5,\n  },\n  defaultMaskNameLabel: {\n    flex: 1,\n    color: '#FFFFFF',\n    fontSize: 12,\n  },\n});\n"],"mappings":"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"}