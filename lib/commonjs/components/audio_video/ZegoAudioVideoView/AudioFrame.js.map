{"version":3,"names":["defaultAvatarSizeRatio","flexStyle","AudioFrame","props","userInfo","showSoundWave","audioViewBackgroudColor","audioViewBackgroudImage","avatarSize","avatarAlignment","soundWaveColor","avatar","soundLevel","setSoundLevel","useState","dimensions","setDimensions","width","height","isLoadError","setIsLoadError","getShotName","name","nl","split","shotName","forEach","part","substring","useEffect","ZegoUIKitInternal","onSoundLevelUpdate","userID","cstyle","container","event","nativeEvent","layout","uri","styles","imgBackground","justifyContent","waveStyle","circleWave","subCircleWave","nameLabel","userName","resizeMode","console","log","bgColor","StyleSheet","create","flex","position","backgroundColor","w","color","opacity","alignSelf","aspectRatio","borderRadius","zIndex","alignContent","marginTop","marginBottom","toString","alignItems","fontSize"],"sources":["AudioFrame.js"],"sourcesContent":["import { View, StyleSheet, Text, ImageBackground, Image } from 'react-native';\nimport React, { useState, useEffect } from 'react';\nimport ZegoUIKitInternal from '../../internal/ZegoUIKitInternal';\n\nconst defaultAvatarSizeRatio = 129 / 375;\nconst flexStyle = ['center', 'flex-start', 'flex-end'];\n\nexport default function AudioFrame(props) {\n  const {\n    userInfo,\n    showSoundWave,\n    audioViewBackgroudColor,\n    audioViewBackgroudImage,\n    avatarSize,\n    avatarAlignment,\n    soundWaveColor = '#6B6A71',\n    avatar = '',\n  } = props;\n\n  const [soundLevel, setSoundLevel] = useState(0);\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n  const [isLoadError, setIsLoadError] = useState(false);\n\n  const getShotName = (name) => {\n    if (!name) {\n      return '';\n    }\n    const nl = name.split(' ');\n    var shotName = '';\n    nl.forEach((part) => {\n      if (part !== '') {\n        shotName += part.substring(0, 1);\n      }\n    });\n    return shotName;\n  };\n\n  useEffect(() => {\n    ZegoUIKitInternal.onSoundLevelUpdate(\n      'AudioFrame' + userInfo.userID,\n      (userID, soundLevel) => {\n        if (userInfo.userID == userID) {\n          setSoundLevel(soundLevel);\n        }\n      }\n    );\n\n    return () => {\n      ZegoUIKitInternal.onSoundLevelUpdate('AudioFrame' + userInfo.userID);\n    };\n  }, []);\n\n  return (\n    <View\n      style={\n        cstyle(audioViewBackgroudColor ? audioViewBackgroudColor : '#4A4B4D')\n          .container\n      }\n      onLayout={(event) => {\n        setDimensions({\n          width: event.nativeEvent.layout.width,\n          height: event.nativeEvent.layout.height,\n        });\n      }}\n    >\n      <ImageBackground\n        source={\n          audioViewBackgroudImage ? { uri: audioViewBackgroudImage } : null\n        }\n        resizeMode=\"cover\"\n        style={[\n          styles.imgBackground,\n          { justifyContent: flexStyle[avatarAlignment] },\n        ]}\n      >\n        {showSoundWave && soundLevel > 5 ? (\n          <View\n            style={\n              waveStyle(\n                (avatarSize\n                  ? avatarSize.width\n                  : defaultAvatarSizeRatio * dimensions.width) +\n                  0.04 * dimensions.width,\n                soundWaveColor,\n                1\n              ).circleWave\n            }\n          >\n            {soundLevel > 10 ? (\n              <View\n                style={\n                  waveStyle(\n                    (avatarSize\n                      ? avatarSize.width\n                      : defaultAvatarSizeRatio * dimensions.width) +\n                      0.06 * dimensions.width,\n                    soundWaveColor,\n                    0.6\n                  ).subCircleWave\n                }\n              />\n            ) : null}\n            {soundLevel > 15 ? (\n              <View\n                style={\n                  waveStyle(\n                    (avatarSize\n                      ? avatarSize.width\n                      : defaultAvatarSizeRatio * dimensions.width) +\n                      +0.08 * dimensions.width,\n                    soundWaveColor,\n                    0.3\n                  ).subCircleWave\n                }\n              />\n            ) : null}\n          </View>\n        ) : (\n          <View />\n        )}\n        <View\n          style={[\n            styles.avatar,\n            {\n              width: avatarSize\n                ? avatarSize.width\n                : defaultAvatarSizeRatio * dimensions.width,\n            },\n          ]}\n        >\n          {\n            (!avatar || isLoadError) ?\n              <Text style={styles.nameLabel}>{getShotName(userInfo.userName)}</Text> :\n              <Image \n                style={{ width: '100%', height: '100%', resizeMode: 'contain' }}\n                resizeMode=\"contain\"\n                source={{ uri: avatar }}\n                onLoadStart={() =>  console.log('avatar onLoadStart')}\n                onLoadEnd={() =>  console.log('avatar onLoadEnd')}\n                onError={() =>  { console.log('avatar onError'); setIsLoadError(true);}}\n                onLoad={() =>  { console.log('avatar onLoad'); setIsLoadError(false);}}\n              />\n          }\n        </View>\n      </ImageBackground>\n    </View>\n  );\n}\n\nconst cstyle = (bgColor) =>\n  StyleSheet.create({\n    container: {\n      flex: 1,\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      justifyContent: 'center',\n      backgroundColor: bgColor,\n    },\n  });\nconst waveStyle = (w, color, opacity) =>\n  StyleSheet.create({\n    circleWave: {\n      flex: 1,\n      position: 'absolute',\n      alignSelf: 'center',\n      width: w, //((w / 375) * 100).toString() + '%',\n      aspectRatio: 1,\n      borderRadius: 1000,\n      backgroundColor: color,\n      opacity: opacity,\n      zIndex: 0,\n      justifyContent: 'center',\n      alignContent: 'center',\n    },\n    subCircleWave: {\n      flex: 1,\n      position: 'absolute',\n      alignSelf: 'center',\n      width: w, //((w / 164) * 100).toString() + '%',\n      aspectRatio: 1,\n      borderRadius: 1000,\n      backgroundColor: color,\n      opacity: opacity,\n      zIndex: 0,\n    },\n  });\nconst styles = StyleSheet.create({\n  imgBackground: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n  },\n  avatar: {\n    flex: 1,\n    marginTop: 1.5,\n    marginBottom: 1.5,\n    width: ((129 / 375) * 100).toString() + '%',\n    aspectRatio: 1,\n    borderRadius: 1000,\n    backgroundColor: '#DBDDE3',\n    position: 'absolute',\n    alignSelf: 'center',\n    alignItems: 'center',\n    justifyContent: 'center',\n    zIndex: 2,\n  },\n  nameLabel: {\n    flex: 1,\n    position: 'absolute',\n    color: '#222222',\n    fontSize: 22,\n  },\n});\n"],"mappings":"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"}