{"version":3,"names":["MaskViewDefault","props","userInfo","userName","styles","defaultMaskContainer","defaultMaskNameLabelContainer","defaultMaskNameLabel","ZegoVideoView","userID","roomID","audioViewBackgroudColor","audioViewBackgroudImage","showSoundWave","useVideoViewAspectFill","foregroundBuilder","avatarSize","avatarAlignment","soundWaveColor","setUserInfo","useState","isCameraOn","setIsCameraOn","propsData","setPropsData","userInfo_","ZegoUIKitInternal","getUser","inRoomAttributes","avatar","setAvatarUrl","useEffect","user","isCameraDeviceOn","callbackID","String","onSDKConnected","onUserInfoUpdate","info","onRoomStateChanged","reason","errorCode","extendedData","isRoomConnected","onUserCountOrPropertyChanged","userList","console","log","forEach","temp","container","videoContainer","mask","StyleSheet","create","flex","width","height","position","zIndex","backgroundColor","opacity","alignSelf","paddingLeft","paddingRight","paddingBottom","paddingTop","borderRadius","bottom","right","color","fontSize"],"sources":["index.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { View, StyleSheet, Text } from 'react-native';\nimport Delegate from 'react-delegate-component';\nimport AudioFrame from './AudioFrame';\nimport VideoFrame from './VideoFrame';\nimport ZegoUIKitInternal from '../../internal/ZegoUIKitInternal';\n\nfunction MaskViewDefault(props) {\n  const { userInfo } = props;\n  const { userName = '' } = userInfo;\n  return (\n    <View style={styles.defaultMaskContainer}>\n      <View style={styles.defaultMaskNameLabelContainer}>\n        <Text style={styles.defaultMaskNameLabel}>{userName}</Text>\n      </View>\n    </View>\n  );\n}\n\nexport default function ZegoVideoView(props) {\n  const {\n    userID,\n    roomID,\n    audioViewBackgroudColor,\n    audioViewBackgroudImage,\n    showSoundWave = true,\n    useVideoViewAspectFill = false,\n    foregroundBuilder,\n    avatarSize,\n    avatarAlignment = 0,\n    soundWaveColor,\n  } = props;\n\n  const [userInfo, setUserInfo] = useState({});\n  const [isCameraOn, setIsCameraOn] = useState(true);\n  const [propsData, setPropsData] = useState({ userInfo: {} });\n  const userInfo_ = ZegoUIKitInternal.getUser(userID);\n  const inRoomAttributes = userInfo_ ? userInfo_.inRoomAttributes : {};\n  const [avatar, setAvatarUrl] = useState(inRoomAttributes ? (inRoomAttributes.avatar || '') : '');\n\n  useEffect(() => {\n    const user = ZegoUIKitInternal.getUser(userID);\n    if (user) {\n      setUserInfo(user);\n      setPropsData({ userInfo: user });\n      setIsCameraOn(user.isCameraDeviceOn);\n    }\n  }, []);\n\n  useEffect(() => {\n    const callbackID = 'ZegoVideoView' + String(userID);\n\n    ZegoUIKitInternal.onSDKConnected(callbackID, () => {\n      const user = ZegoUIKitInternal.getUser(userID);\n      if (user) {\n        setUserInfo(user);\n        setPropsData({ userInfo: user });\n        setIsCameraOn(user.isCameraDeviceOn);\n      }\n    });\n    ZegoUIKitInternal.onUserInfoUpdate(callbackID, (info) => {\n      if (info.userID == userID) {\n        setIsCameraOn(info.isCameraDeviceOn);\n        setUserInfo(info);\n        setPropsData({ userInfo: info });\n      }\n    });\n    ZegoUIKitInternal.onRoomStateChanged(\n      callbackID,\n      (reason, errorCode, extendedData) => {\n        if (ZegoUIKitInternal.isRoomConnected()) {\n          const user = ZegoUIKitInternal.getUser(userID);\n          if (user) {\n            setIsCameraOn(user.isCameraDeviceOn);\n          }\n        }\n      }\n    );\n    ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID, (userList) => {\n      console.log('=========[ZegoVideoView]onUserCountOrPropertyChanged=========', userID, userList);\n      userList.forEach((user) => {\n        const temp = user.inRoomAttributes ? user.inRoomAttributes.avatar : '';\n        if (user.userID === userID && temp) {\n          setAvatarUrl(temp);\n        }\n      });\n    });\n    return () => {\n      ZegoUIKitInternal.onSDKConnected(callbackID);\n      ZegoUIKitInternal.onUserInfoUpdate(callbackID);\n      ZegoUIKitInternal.onRoomStateChanged(callbackID);\n      ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID);\n    };\n  }, []);\n\n  return (\n    <View style={styles.container}>\n      <VideoFrame\n        style={styles.videoContainer}\n        userID={userID}\n        roomID={roomID}\n        fillMode={useVideoViewAspectFill ? 1 : 0} // 1:AspectFill, 0:AspectFit\n      >\n        {!isCameraOn ? (\n          <AudioFrame\n            userInfo={userInfo}\n            showSoundWave={showSoundWave}\n            audioViewBackgroudColor={audioViewBackgroudColor}\n            audioViewBackgroudImage={audioViewBackgroudImage}\n            avatarSize={avatarSize}\n            avatarAlignment={avatarAlignment}\n            avatar={avatar}\n            soundWaveColor={soundWaveColor}\n          />\n        ) : null}\n      </VideoFrame>\n\n      <Delegate\n        style={styles.mask}\n        to={foregroundBuilder}\n        default={MaskViewDefault}\n        props={propsData}\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n  },\n  videoContainer: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    zIndex: 1,\n  },\n  mask: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    zIndex: 2,\n  },\n  defaultMaskContainer: {\n    flex: 1,\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    zIndex: 2,\n  },\n  defaultMaskNameLabelContainer: {\n    flex: 1,\n    backgroundColor: '#2A2A2A',\n    opacity: 0.5,\n    position: 'absolute',\n    alignSelf: 'center',\n    paddingLeft: 5,\n    paddingRight: 5,\n    paddingBottom: 3,\n    paddingTop: 3,\n    borderRadius: 6,\n    bottom: 5,\n    right: 5,\n  },\n  defaultMaskNameLabel: {\n    flex: 1,\n    color: '#FFFFFF',\n    fontSize: 12,\n  },\n});\n"],"mappings":"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"}